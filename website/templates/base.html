<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

  <title>{% block title %}{{ _("Home") }}{% endblock %}</title>
</head>

<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <a class="navbar-brand" href="/">{{ _("Finance Management") }}</a>

  <div class="collapse navbar-collapse">
    <ul class="navbar-nav ml-auto">

      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle"
          href="#"
          id="languageDropdown"
          role="button"
          data-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="false">

            {% if session.get('lang', 'en') == 'lv' %}
                {{ _("Latvian") }}
            {% else %}
                {{ _("English") }}
            {% endif %}
        </a>

        <div class="dropdown-menu dropdown-menu-right">
            <a class="dropdown-item"
              href="{{ url_for('views.set_language', lang='en') }}">
              {{ _("English") }}
            </a>
            <a class="dropdown-item"
              href="{{ url_for('views.set_language', lang='lv') }}">
              {{ _("Latvian") }}
            </a>
        </div>
      </li>

      {% if current_user.is_authenticated %}
        <li class="nav-item">
          <a class="nav-link" href="/">{{ _("Home") }}</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="/expenses">{{ _("Expenses") }}</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="/profile">{{ _("Profile") }}</a>
        </li>

        {% if current_user.is_admin %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle"
             href="#"
             id="adminDropdown"
             role="button"
             data-toggle="dropdown"
             aria-haspopup="true"
             aria-expanded="false">
             {{ _("Admin panel") }}
          </a>

          <div class="dropdown-menu dropdown-menu-right">
            <a class="dropdown-item" href="/admin/users">
              {{ _("Users") }}
            </a>
            <a class="dropdown-item" href="/admin/categories">
              {{ _("Categories") }}
            </a>
            <a class="dropdown-item" href="/admin/audit">
              {{ _("Audit logs") }}
            </a>
          </div>
        </li>
        {% endif %}

        <li class="nav-item">
          <a class="nav-link" href="/logout">{{ _("Logout") }}</a>
        </li>

      {% else %}
        <li class="nav-item">
          <a class="nav-link" href="/login">{{ _("Login") }}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/sign-up">{{ _("Sign up") }}</a>
        </li>
        

      {% endif %}

    </ul>
  </div>
</nav>

<div class="container mt-4">

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% for category, message in messages %}
      <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }}">
        {{ message }}
      </div>
    {% endfor %}
  {% endwith %}

  {% block content %}{% endblock %}
</div>

<script src="{{ url_for('static', filename='index.js') }}"></script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>

</body>
</html>
